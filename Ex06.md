## 計算機科学演習　第9回

### 目的:
文字（コンピュータでの文字の扱われ方を理解する）

### 本日の内容:
1. 前回の復習
2. 文字（コンピュータでの文字の扱われ方を理解する）

### 前回までの復習（重要項目）
#### 配列
- 配列は`型　変数名[個数]`と宣言する  
例:  
    ```cpp
    int a[10]; //int型の配列で10個のデータを扱う場合
    ```
- 配列のデータにアクセスする場合は`変数名[番号]`のように使う  
例:
    ```cpp
    
    a[0]; // int型の配列で1番目のデータにアクセス 注意:カッコ内の数字は0から始まる
    a[1]; // int型の配列で2番目のデータにアクセス
    ...
    a[N-1]; // int型の配列でN番目のデータにアクセス
    ```
#### メモリとアドレス
- プログラムを実行すると変数と関数はメモリ上のどこかに領域を確保する
- メモリ上の位置を`アドレス`といい、番号が振られている
- アドレスは普通の`変数は前に & を付けて、配列と関数は名前だけで取得できる`

![メモリとディスクのイメージ図](Ex05_Fig01.png)

#### ポインタ
- ある <型> のアドレスを格納するポインタはその <型> に * を付けた型で宣言する  
  例： 
  ```cpp
  // 宣言の方法はどれでもOK
  int* p
  int *p
  int * p
  ```
- ポインタはアドレスを格納するための変数  
  ```cpp
  int a; // aはint型の変数
  int* p = &a; //  & を付けて変数aのアドレスを取得 -> 代入
  ``` 
- ポインタに * をつけると、pに入力されているアドレスのデータにアクセスできる。  
そのアドレスにある変数の代わりになる（参照）  
  ```cpp
  int a; // int型の変数aを宣言
  int* p // int型のポインタ変数pを宣言

  p = &a; // pに変数aのアドレスを代入

  *p = 5; // 変数aに5を代入（参照の機能）
  ```

#### 参照渡し
- 引数をポインタにすると別の関数の内部変数を操作できる  

  ```cpp
  // 参照渡しされた変数に対して5を加算する関数
  void func(int* p)
  {
      //（参照）pに格納されているアドレスの変数に5を加算する
      *p += 5;  
  }
  
  int main()
  {
      // int型の変数aを宣言
      int a = 2;
  
      //　関数funcに変数aのアドレスを引数で渡す
      func(&a);
  
      printf("a = %d¥n", a);
  
      return 0;
  }
  ```

### 配列再考
- 配列変数を引数にとるときは、配列変数のアドレスを渡し、ポインタで受ける
- ポインタも`配列変数と同じく [ ] で各要素を参照できる`
- 配列変数は、`メモリ上に連続して存在している`  
解説: [ ] は、<アドレス>[<番号>] としたときに、指定した <アドレス> から <番号> × <型の大きさ> だけ進めたところにある変数を使用するときに使うもの

### アドレスの演算
- アドレスの計算は、その型の大きさ（int型だと4バイト）に左右される
- アドレスの計算は、加減算しかできない

### 文字（コンピュータでの文字の扱われ方を理解する）
- 文字は通し番号で扱う
- 通し番号は文字コードと呼ばれる
- 半角文字は１バイト、全角文字は２バイト

### 文字集合
文字の集合。世界中で使用する文字を一つの表にまとめることは困難。グループに分類されている。例えば「アルファベット・記号」のグループや「ひらがな・カタカナ・漢字」、「ハングル文字」…など。我々が良く使用している文字集合には

- ASCII … 半角英数字・半角記号 (a,A,0,!,@,# など) 
- JIS X 0201 … 半角英数字・半角カナ  
（参考HP: [http://ash.jp/code/codetbl1.htm](http://ash.jp/code/codetbl1.htm)）
- JIS X 0208 … ひらがな・カタカナ・漢字・全角記号  
（参考HP: [http://ash.jp/code/codetbl2.htm](http://ash.jp/code/codetbl2.htm)）

がある。

### エンコーディング
複数の文字集合を扱うための枠組み。文字集合はその文字に対する番号が定義されているだけである。二つのコードを同時に扱う場合、番号が重複する可能性があり，コンピュータはどちらの文字であるかを判断できない。これを判断できるようにするためには、
（例としてASCIIコード「A」とJIS X0208「あ」が重複していると仮定すると） 

1.	「A」はそのままだけど、「あ」の番号を加工して「A」と重ならないようにする 
2.	「A」も「あ」も番号は変えずに、区切りごとに特別なコード、 たとえば「ここから先は ASCII」「ここから先は JIS X 0208」という意味の、区切り用のコードを入れる。 

という2通りの対策が考えられる。さらに、1.ならば、どういうふうに「あ」を加工するのか 2.ならば、どういう区切りのコードを入れるのかという細かな規格を決める必要がある。このような、複数の文字集合を同時に扱うための規則のことを「エンコーディング」と呼ぶ。我々が主に使用しているエンコーディングには、ISO-2022-JP と Shift_JIS と EUC-JP の3種類である。

・ISO-2022-JP（JIS）エンコーディング
ASCII・JIS X 0201 の一部・JIS X 0208 を扱うことができる。 ASCII・JIS X 0201・JIS X 0208 を判別するために、区切り用のコードを入れている。

#### 演習1
ASCIIコードを表示してみよう！ “a”のコードを表示するプログラム
```cpp
#include <stdio.h>

int main()
{
    // char型の変数cに文字'a'を格納する
    char c = 'a';

    // cを文字として表示する
    printf("変数cに格納された文字は%c。¥n", c);

    // cを数値（16進数）として表示する
    printf("変数cに格納された文字は%2x。¥n", c);

    return 0;
}
```
注意：  
<span style="color: red; ">文字</span>を扱うときには`「'」シングル`クォーテーションで囲む  
<span style="color: red; ">文字列</span>を扱うときには`「"」ダブル`クォーテーションで囲む

#### 演習2
“abcdef”のコードを表示するプログラムを作成せよ。  
ヒント: char型の配列を使う
```cpp
#include <stdio.h>

int main()
{
    // char型の配列cを宣言
    char c[6];
    c[0] = 'a';
    c[1] = 'b';
    c[2] = 'c';
    c[3] = 'd';
    c[4] = 'e';
    c[5] = 'f';

    for( int i = 0; i < 6; i++)
    {
        // cを文字として表示する
        printf("変数cに格納された文字は%c。¥n", c[i]);

        // cを数値（16進数）として表示する
        printf("変数cに格納された文字は%2x。¥n", c[i]);
    }
    
    return 0;
}
```
注意：  
文字列の最後には「0x0」 NULLが挿入される。  
NULLは文字列の終わりを示している。

#### 演習3
全角文字を扱う。  
これまで扱ってきた半角文字とは異なり，全角文字は2バイトの数値で表現される。  
例えば、Shift_JISコードでは上位バイトに、半角文字を表現する際に使われていない数値である「81～9F」と「E0～EF」を使い、 下位バイトと組み合わせて、 2バイトの数値で全角文字を表現する。
```cpp
#include <stdio.h>

int main()
{
    // char型の配列c（2バイト全角のため）を宣言
    char c[] = "あ"; //全角の"あ"を代入

    // cを文字として表示する
    printf("変数cに格納された文字は%s。¥n", c);

    // cを数値（16進数）として表示する
    printf("変数cに格納された文字は%2x%2x。¥n", (unsigned char)c[0], (unsigned char)c[1]);
    
    return 0;
}
```
#### 課題
文字コードを入力して自分の名前を表示するプログラムを作成せよ。  
参考HP(Shift-JIS 2バイトコード): [http://charset.7jp.net/sjis.html](http://charset.7jp.net/sjis.html)

課題の登録: https://ws.formzu.net/fgen/S32413550/

ヒント（'ふじた'を表示する場合）:
```cpp
#include <stdio.h>

int main()
{
    unsigned char c[256];

    // 16進数（注意: 先頭に"0x"をつける）でコードを入力する
    c[0] = 0x82;
    c[1] = 0xD3;
    c[2] = 0x82;
    c[3] = 0xB6;
    c[4] = 0x82;
    c[5] = 0xBD;
    c[6] = 0x0; //再度にNULLを挿入する（文字列の最後を指定するため）

    char *s = (char *)c;

    printf("私の名前は  %s  です。¥n",s);

    return 0;
}
```